const MUSICAS_RAW = [
  {
    "id": 1,
    "titulo": "A Cruz Vazia",
    "artista": "Kleber Lucas",
    "referLink": "mHu3UqXJ4tU",
    "categorias": "Morte e Ressurreição",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "hard",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 2,
    "titulo": "Abraça-me",
    "artista": "David Quinlan",
    "referLink": "com5UB-SWYY",
    "categorias": "Intimidade com Deus; Confiança e Esperança; Amor de Deus",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 3,
    "titulo": "Senhor e Rei",
    "artista": "Davi Sacer",
    "referLink": "zPD2W9WEm8s",
    "categorias": "Engrandecimento e Exaltação; Adoração Congregacional",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "hard",
      "sax": ""
    }
  },
  {
    "id": 4,
    "titulo": "Agnus Dei",
    "artista": "Michael W. Smith",
    "referLink": "ag1StnggWkM",
    "categorias": "Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 5,
    "titulo": "Além do Rio Azul",
    "artista": "Voz da Verdade",
    "referLink": "QpBNXkKIYZw",
    "categorias": "Segunda Vinda",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 7,
    "titulo": "Aquieta minh'alma",
    "artista": "Ministério Zoe",
    "referLink": "ANfpF0pNob4",
    "categorias": "Intimidade com Deus; Confiança e Esperança; Amor de Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 8,
    "titulo": "Atos 2",
    "artista": "Gabriela Rocha",
    "referLink": "WWrU6LC_4ho",
    "categorias": "Engrandecimento e Exaltação; Adoração Congregacional",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 9,
    "titulo": "Caminho no Deserto",
    "artista": "Bethel Music",
    "referLink": "VuApXUlveLM",
    "categorias": "Engrandecimento e Exaltação; Confiança e Esperança; Adoração Congregacional",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 10,
    "titulo": "Canção do Apocalipse",
    "artista": "Diante do Trono",
    "referLink": "5j0arvaKdqk",
    "categorias": "Engrandecimento e Exaltação; Segunda Vinda",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "easy",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 11,
    "titulo": "Colossenses e suas Linhas de Amor",
    "artista": "Fhop Music",
    "referLink": "MeX0yHMs9Nk",
    "categorias": "Morte e Ressurreição; Amor de Deus",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "hard",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 12,
    "titulo": "Depois da Cruz",
    "artista": "Aline Barros",
    "referLink": "BcX-KWrsSYk",
    "categorias": "Morte e Ressurreição",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 13,
    "titulo": "Ele continua sendo bom",
    "artista": "Paulo César Baruk",
    "referLink": "3aYIoi1q2Do",
    "categorias": "Engrandecimento e Exaltação; Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 14,
    "titulo": "Ele vem",
    "artista": "Gabriel Guedes",
    "referLink": "YudXB8MZRTs",
    "categorias": "Segunda Vinda",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 15,
    "titulo": "Em Espírito e em Verdade",
    "artista": "Ministério Koinonya",
    "referLink": "b8RSKRumBRs",
    "categorias": "Adoração Congregacional; Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "hard",
      "baixo": "hard",
      "violao": "",
      "bateria": "hard",
      "teclado": "hard",
      "sax": ""
    }
  },
  {
    "id": 16,
    "titulo": "Em teus Braços",
    "artista": "Laura Souguellis",
    "referLink": "IxpWNuxGmzc",
    "categorias": "Confiança e Esperança; Intimidade com Deus",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 17,
    "titulo": "Escape",
    "artista": "Renascer Praise",
    "referLink": "vM2A2XEm9TE",
    "categorias": "Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "hard",
      "teclado": "medium",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 18,
    "titulo": "Eu me rendo",
    "artista": "Leonardo Gonçalves",
    "referLink": "_SzVzMh7qfM",
    "categorias": "Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 19,
    "titulo": "Eu me rendo",
    "artista": "Hillsong",
    "referLink": "_qDKrvstS9c",
    "categorias": "Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 20,
    "titulo": "Eu quebro meu vaso",
    "artista": "Som do Reino",
    "referLink": "RXlDfjDg738",
    "categorias": "Intimidade com Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 21,
    "titulo": "Que Amor é esse",
    "artista": "Luma Elpídio",
    "referLink": "xu8Zel1u-6k",
    "categorias": "Amor de Deus;Intimidade com Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 22,
    "titulo": "Filho do Deus Vivo",
    "artista": "Nívea Soares",
    "referLink": "PdJoTcOgwUA",
    "categorias": "Morte e Ressurreição; Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "hard",
      "baixo": "medium",
      "violao": "",
      "bateria": "hard",
      "teclado": "easy",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 23,
    "titulo": "Galileu",
    "artista": "Fernandinho",
    "referLink": "bOFbr2RpLek",
    "categorias": "Morte e Ressurreição; Amor de Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 24,
    "titulo": "Grande é o Senhor",
    "artista": "Adhemar de Campos",
    "referLink": "icalvyOpiAU",
    "categorias": "Adoração Congregacional; Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 25,
    "titulo": "Jesus em tua Presença",
    "artista": "Asaph Borba",
    "referLink": "aMpM68cb5MY",
    "categorias": "Adoração Congregacional; Morte e Ressurreição",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 26,
    "titulo": "Jesus, meu Primeiro Amor",
    "artista": "Fernanda Brum",
    "referLink": "q6B4MMSxzQQ",
    "categorias": "Intimidade com Deus; Amor de Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 27,
    "titulo": "Jesus, o Plano Perfeito",
    "artista": "Renascer Praise",
    "referLink": "OtDvlKRgJrc",
    "categorias": "Morte e Ressurreição; Amor de Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 28,
    "titulo": "Lugar Secreto",
    "artista": "Gabriela Rocha",
    "referLink": "YnrN0o0lubM",
    "categorias": "Intimidade com Deus; Confiança e Esperança; Glória de Deus",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "hard",
      "baixo": "easy",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 29,
    "titulo": "Maranata",
    "artista": "Ministério Avivah",
    "referLink": "iS6GXPbhCwU",
    "categorias": "Segunda Vinda",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 30,
    "titulo": "Maravilhosa Graça",
    "artista": "Bethel Music",
    "referLink": "nv-T2_JPKZA",
    "categorias": "Morte e Ressurreição; Adoração Congregacional; Amor de Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 31,
    "titulo": "Me atraiu",
    "artista": "Gabriela Rocha",
    "referLink": "Z6cONvRUFZQ",
    "categorias": "Glória de Deus; Intimidade com Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 32,
    "titulo": "Me derramar",
    "artista": "Vineyard",
    "referLink": "qsmHYPk4XGM",
    "categorias": "Adoração Congregacional; Intimidade com Deus",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 33,
    "titulo": "Único",
    "artista": "Fhop Music",
    "referLink": "0vCmIKyJPRI",
    "categorias": "Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 34,
    "titulo": "Meu Maior Amor",
    "artista": "Nívea Soares",
    "referLink": "V9zmVN6KcJw",
    "categorias": "Amor de Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "hard",
      "baixo": "hard",
      "violao": "",
      "bateria": "hard",
      "teclado": "medium",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 35,
    "titulo": "Mil Graus",
    "artista": "Renascer Praise",
    "referLink": "QTC7_DVENZA",
    "categorias": "Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "hard",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 36,
    "titulo": "Na Corte do Egito",
    "artista": "Trazendo a Arca",
    "referLink": "pSMeSrg4zqo",
    "categorias": "Glória de Deus",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "hard",
      "baixo": "hard",
      "violao": "",
      "bateria": "hard",
      "teclado": "hard",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 37,
    "titulo": "Santo pra Sempre",
    "artista": "Bethel Music",
    "referLink": "ijNCc7ICCck",
    "categorias": "Adoração Congregacional; Engrandecimento e Exaltação; Glória de Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 38,
    "titulo": "Nada Além do Sangue",
    "artista": "Fernandinho",
    "referLink": "csPaNdL6ndA",
    "categorias": "Morte e Ressurreição",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 39,
    "titulo": "Ninguém explica Deus",
    "artista": "Preto no Branco",
    "referLink": "LYsaKn8FRhc",
    "categorias": "Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "hard",
      "baixo": "",
      "violao": "",
      "bateria": "",
      "teclado": "medium",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 40,
    "titulo": "O Escudo + Sou um Milagre",
    "artista": "Lukas Agustinho",
    "referLink": "lWax47zymUE",
    "categorias": "Engrandecimento e Exaltação; Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 41,
    "titulo": "O que tua Glória fez comigo",
    "artista": "Fernanda Brum",
    "referLink": "9fZph9kZkgM",
    "categorias": "Glória de Deus; Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 42,
    "titulo": "Oceanos",
    "artista": "Hillsong",
    "referLink": "2LeqOo2EV24",
    "categorias": "Confiança e Esperança; Intimidade com Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 43,
    "titulo": "Oh, Quão Lindo Esse Nome É",
    "artista": "Hillsong",
    "referLink": "8XUqcxgH8r4",
    "categorias": "Morte e Ressurreição; Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 44,
    "titulo": "Ousado Amor",
    "artista": "Bethel Music",
    "referLink": "wSKKEAnLTDw",
    "categorias": "Morte e Ressurreição; Amor de Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 45,
    "titulo": "Ouvir o teu Falar",
    "artista": "Discopraise",
    "referLink": "2Z6nW7jU_uU",
    "categorias": "Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 46,
    "titulo": "Pra Sempre",
    "artista": "Gateway Church",
    "referLink": "DZvBlrJsFag",
    "categorias": "Morte e Ressurreição",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 47,
    "titulo": "Pode Morar Aqui",
    "artista": "Theo Rubia",
    "referLink": "n0fDvJAyrQ8",
    "categorias": "Segunda Vinda",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 48,
    "titulo": "Preciso de Ti",
    "artista": "Diante do Trono",
    "referLink": "ieyQpi1j78E",
    "categorias": "Confiança e Esperança; Intimidade com Deus; Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 49,
    "titulo": "Quebrantado",
    "artista": "Bethel Music",
    "referLink": "QbnmpJo3DiI",
    "categorias": "Morte e Ressurreição; Amor de Deus",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 51,
    "titulo": "Ruja o Leão",
    "artista": "Isaias Saad",
    "referLink": "gTRFVMkMajw",
    "categorias": "Segunda Vinda; Engrandecimento e Exaltação; Glória de Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 52,
    "titulo": "Santo",
    "artista": "Fernanda Brum",
    "referLink": "DVgv6lE0aKE",
    "categorias": "Glória de Deus;Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 53,
    "titulo": "Se eu me humilhar",
    "artista": "Discopraise",
    "referLink": "XEa2jjT9SyQ",
    "categorias": "Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 54,
    "titulo": "Teu Reino",
    "artista": "Ministério Cristo Vivo",
    "referLink": "lMhEFpHzRsY",
    "categorias": "Adoração Congregacional; Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 55,
    "titulo": "Tu És + Águas Purificadoras",
    "artista": "Fhop Music",
    "referLink": "YXnQ02HYB1w",
    "categorias": "Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 56,
    "titulo": "Tu És Bom",
    "artista": "Adoração & Adoradores",
    "referLink": "4gDi8FIJKHc",
    "categorias": "Engrandecimento e Exaltação; Adoração Congregacional",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 57,
    "titulo": "Tua Graça me basta",
    "artista": "Davi Sacer",
    "referLink": "4y0_rOSnb_g",
    "categorias": "Engrandecimento e Exaltação; Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "hard",
      "baixo": "medium",
      "violao": "",
      "bateria": "easy",
      "teclado": "medium",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 58,
    "titulo": "Vem me Buscar",
    "artista": "Jefferson e Suellen",
    "referLink": "t6Pd8gXIASU",
    "categorias": "Segunda Vinda",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "hard",
      "teclado": "easy",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 59,
    "titulo": "Vim para Adorar-te",
    "artista": "Hillsong",
    "referLink": "-4AAHPM98Do",
    "categorias": "Adoração Congregacional; Engrandecimento e Exaltação; Morte e Ressurreição",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 60,
    "titulo": "Boa Parte",
    "artista": "Fhop Music",
    "referLink": "dlGOiuxSzVw",
    "categorias": "Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "easy",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 61,
    "titulo": "Os que confiam no Senhor",
    "artista": "Marcos Góes",
    "referLink": "5qMJJPwoJZE",
    "categorias": "Engrandecimento e Exaltação; Adoração Congregacional; Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 62,
    "titulo": "Até que o Senhor venha",
    "artista": "Cultura do Céu",
    "referLink": "E0F9NvrSoa0",
    "categorias": "Glória de Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 63,
    "titulo": "Solta o Cabo da Nau",
    "artista": "Harpa Cristã",
    "referLink": "5Vp1NWgqZEU",
    "categorias": "Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "hard",
      "violao": "",
      "bateria": "hard",
      "teclado": "easy",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 64,
    "titulo": "Alvo mais que a Neve",
    "artista": "Harpa Cristã",
    "referLink": "NI89N8QBOoM",
    "categorias": "Morte e Ressurreição",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 65,
    "titulo": "Rude Cruz",
    "artista": "Harpa Cristã",
    "referLink": "FncNPmyDjzg",
    "categorias": "Morte e Ressurreição",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    },
    "ban": true
  },
  {
    "id": 66,
    "titulo": "Redenção",
    "artista": "Fernanda Brum",
    "referLink": "_2BImNvixHw",
    "categorias": "Morte e Ressurreição",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "hard",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "hard",
      "sax": ""
    }
  },
  {
    "id": 67,
    "titulo": "Santo Espírito",
    "artista": "Laura Souguellis",
    "referLink": "jF23NIVWapo",
    "categorias": "Glória de Deus; Intimidade com Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 68,
    "titulo": "Estamos de Pé",
    "artista": "Marcus Salles",
    "referLink": "4x-yrCz1D9g",
    "categorias": "Confiança e Esperança; Adoração Congregacional",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 69,
    "titulo": "Redenção - Projeto Sola",
    "artista": "Projeto Sola",
    "referLink": "sX0KVSex6lI",
    "categorias": "Morte e Ressurreição; Amor de Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 82,
    "titulo": "Êxodo",
    "artista": "Projeto Sola",
    "referLink": "GlF6k39Bj0g",
    "categorias": "Morte e Ressurreição; Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "hard",
      "baixo": "medium",
      "violao": "",
      "bateria": "hard",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 70,
    "titulo": "Graça",
    "artista": "Israel Salazar",
    "referLink": "_hL1pguiHX0",
    "categorias": "Morte e Ressurreição; Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "hard",
      "baixo": "hard",
      "violao": "",
      "bateria": "hard",
      "teclado": "hard",
      "sax": ""
    }
  },
  {
    "id": 71,
    "titulo": "No Meio dos Louvores",
    "artista": "Israel Salazar",
    "referLink": "Ts1h1EDiLpc",
    "categorias": "Adoração Congregacional",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "hard",
      "baixo": "hard",
      "violao": "",
      "bateria": "hard",
      "teclado": "hard",
      "sax": ""
    }
  },
  {
    "id": 72,
    "titulo": "Creio que Tu és a Cura",
    "artista": "Gabriela Rocha",
    "referLink": "4X0mSNyZcxQ",
    "categorias": "Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 73,
    "titulo": "De Graça em Graça",
    "artista": "Hillsong",
    "referLink": "SMRN-uXRQmc",
    "categorias": "Morte e Ressurreição; Amor de Deus",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 74,
    "titulo": "Ao Único que é Digno",
    "artista": "Bené Gomes",
    "referLink": "thhBwc3qLfE",
    "categorias": "Engrandecimento e Exaltação; Adoração Congregacional",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 75,
    "titulo": "O Nosso General é Cristo",
    "artista": "Dany Grace",
    "referLink": "dS35Xhf2UeI",
    "categorias": "Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "medium",
      "baixo": "hard",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 76,
    "titulo": "Vitorioso És",
    "artista": "Bethel Music",
    "referLink": "k7tGP-vidwc",
    "categorias": "Engrandecimento e Exaltação; Adoração Congregacional",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 77,
    "titulo": "O Espírito de Deus está Aqui",
    "artista": "Bené Gomes",
    "referLink": "7ivOU0qJUbQ",
    "categorias": "Glória de Deus; Intimidade com Deus; Adoração Congregacional",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "hard",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 78,
    "titulo": "Palavras",
    "artista": "Lauriete",
    "referLink": "Hb5J1-ovVZA",
    "categorias": "Confiança e Esperança; Intimidade com Deus",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 79,
    "titulo": "Só uma Coisa me satisfaz",
    "artista": "Ministério Zoe",
    "referLink": "AkGogdtNlkE",
    "categorias": "Glória de Deus; Intimidade com Deus",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "hard",
      "sax": ""
    }
  },
  {
    "id": 80,
    "titulo": "Quão Formoso És",
    "artista": "Ministério Koinonya",
    "referLink": "ORomQ177Utg",
    "categorias": "Engrandecimento e Exaltação; Glória de Deus",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "hard",
      "baixo": "hard",
      "violao": "",
      "bateria": "medium",
      "teclado": "hard",
      "sax": ""
    }
  },
  {
    "id": 81,
    "titulo": "Clamo Jesus",
    "artista": "Paulo César Baruk",
    "referLink": "ye9caqETC0A",
    "categorias": "Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 82,
    "titulo": "Somente Cristo",
    "artista": "Fhop Music",
    "referLink": "7sX_vqk8VeE",
    "categorias": "Amor de Deus; Morte e Ressurreição; Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 83,
    "titulo": "Sublime",
    "artista": "Fhop Music",
    "referLink": "7GWZwO0MdsY",
    "categorias": "Adoração Congregacional; Engrandecimento e Exaltação; Segunda Vinda",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 84,
    "titulo": "Gratidão",
    "artista": "Fhop Music",
    "referLink": "3SEz_SemHtk",
    "categorias": "Adoração Congregacional; Engrandecimento e Exaltação; Intimidade com Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 85,
    "titulo": "Só Tu és Santo",
    "artista": "Morada",
    "referLink": "REJGnZQIFnA",
    "categorias": "Adoração Congregacional; Engrandecimento e Exaltação; Intimidade com Deus",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 86,
    "titulo": "Eu vou Construir",
    "artista": "Juliano Son",
    "referLink": "1htnqzaKLP8",
    "categorias": "Adoração Congregacional; Engrandecimento e Exaltação; Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 87,
    "titulo": "Quem é esse?",
    "artista": "Julliany Souza",
    "referLink": "0ZF5em0MTwY",
    "categorias": "Morte e Ressurreição; Engrandecimento e Exaltação; Amor de Deus",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 88,
    "titulo": "Hosana",
    "artista": "Hillsong",
    "referLink": "2UtcyWiS2aI",
    "categorias": "Adoração Congregacional;Segunda Vinda",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 89,
    "titulo": "Louve",
    "artista": "Elevation Worship",
    "referLink": "mL3pDu4NYJw",
    "categorias": "Adoração Congregacional; Engrandecimento e Exaltação; Morte e Ressurreição",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "hard",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 90,
    "titulo": "Nada é Impossível",
    "artista": "Planetshakers",
    "referLink": "kIp7xyZYbp4",
    "categorias": "Engrandecimento e Exaltação; Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "medium",
      "baixo": "medium",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 91,
    "titulo": "Quero subir",
    "artista": "Diante do Trono",
    "referLink": "JpdwXAp_1iM",
    "categorias": "Engrandecimento e Exaltação; Intimidade com Deus",
    "versiculos": "",
    "level": {
      "vocal": "hard",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 92,
    "titulo": "Rompendo em Fé",
    "artista": "CEIZS",
    "referLink": "3iwWQJk6OBw",
    "categorias": "Confiança e Esperança",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 93,
    "titulo": "Digno é o Cordeiro",
    "artista": "Davi Silva",
    "referLink": "BfOJEuR5chE",
    "categorias": "Engrandecimento e Exaltação",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "easy",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  },
  {
    "id": 94,
    "titulo": "Vencendo vem Jesus",
    "artista": "Harpa Cristã",
    "referLink": "-swhFRi7czM",
    "categorias": "Segunda Vinda",
    "versiculos": "",
    "level": {
      "vocal": "medium",
      "guitarra": "hard",
      "baixo": "hard",
      "violao": "",
      "bateria": "medium",
      "teclado": "medium",
      "sax": ""
    }
  },
  {
    "id": 95,
    "titulo": "Tu és Soberano",
    "artista": "Ministério Koinonya",
    "referLink": "kUxCKk5EQFg",
    "categorias": "Adoração Congregacional; Engrandecimento e Exaltação; Amor de Deus",
    "versiculos": "",
    "level": {
      "vocal": "easy",
      "guitarra": "medium",
      "baixo": "easy",
      "violao": "",
      "bateria": "easy",
      "teclado": "easy",
      "sax": ""
    }
  }
];

const INTEGRANTES_RAW = [
  {
    "id": 1,
    "nome": "Lucas",
    "icon": "fas fa-keyboard",
    "function": [
      {
        "teclado": "hard"
      }
    ]
  },
  {
    "id": 2,
    "nome": "Matheus",
    "icon": "fas fa-drum",
    "function": [
      {
        "bateria": "hard",
        "guitarra": "medium",
        "violao": "medium",
        "baixo": "medium"
      }
    ]
  },
  {
    "id": 3,
    "nome": "Douglas",
    "icon": "fas fa-guitar",
    "function": [
      {
        "bateria": "medium"
      }
    ]
  },
  {
    "id": 4,
    "nome": "Emerson",
    "icon": "fas fa-bass-guitar",
    "function": [
      {
        "vocal": "medium"
      }
    ]
  },
  {
    "id": 5,
    "nome": "Flor",
    "icon": "fas fa-saxophone",
    "function": [
      {
        "vocal": "medium"
      }
    ]
  },
  {
    "id": 6,
    "nome": "Guilherme",
    "icon": "fas fa-guitar",
    "function": [
      {
        "baixo": "medium"
      }
    ]
  },
  {
    "id": 7,
    "nome": "Rebeca",
    "icon": "fas fa-microphone",
    "function": [
      {
        "vocal": "medium"
      }
    ]
  },
  {
    "id": 8,
    "nome": "Tainá",
    "icon": "fas fa-keyboard",
    "function": [
      {
        "vocal": "medium"
      }
    ]
  },
  {
    "id": 9,
    "nome": "Thaís",
    "icon": "fas fa-drum",
    "function": [
      {
        "vocal": "medium"
      }
    ]
  },
  {
    "id": 11,
    "nome": "Pedro",
    "icon": "fas fa-bass-guitar",
    "function": [
      {
        "sax": "medium"
      }
    ]
  },
  {
    "id": 12,
    "nome": "Rhaldney",
    "icon": "fas fa-microphone",
    "function": [
      {
        "baixo": "hard",
        "guitarra": "medium"
      }
    ]
  },
  {
    "id": 13,
    "nome": "Diogo",
    "icon": "fas fa-microphone",
    "function": [
      {
        "guitarra": "hard"
      }
    ]
  },
  {
    "id": 14,
    "nome": "Mayara",
    "icon": "fas fa-microphone",
    "function": [
      {
        "vocal": "medium"
      }
    ]
  },
  {
    "id": 15,
    "nome": "Alan",
    "icon": "fas fa-microphone",
    "function": [
      {
        "vocal": "medium"
      }
    ]
  },
  {
    "id": 16,
    "nome": "Milena",
    "icon": "fas fa-microphone",
    "function": [
      {
        "teclado": "medium"
      }
    ]
  },
  {
    "id": 17,
    "nome": "Yasmim",
    "icon": "fas fa-microphone",
    "function": [
      {
        "teclado": "medium"
      }
    ]
  },
  {
    "id": 18,
    "nome": "Eli",
    "icon": "fas fa-microphone",
    "function": [
      {
        "sax": "medium"
      }
    ]
  }
];

const HISTORICO_RAW = [
  {
    "data": "02/02/2025",
    "integrantes": [
      4,
      7,
      8,
      2,
      6,
      13,
      1,
      11
    ],
    "musicas": [
      61,
      54,
      55
    ]
  },
  {
    "data": "09/02/2025",
    "integrantes": [
      9,
      5,
      15,
      3,
      12,
      13,
      1,
      11
    ],
    "musicas": [
      66,
      11,
      10
    ]
  },
  {
    "data": "16/02/2025",
    "integrantes": [
      4,
      9,
      14,
      2,
      6,
      12,
      1,
      11
    ],
    "musicas": [
      58,
      47,
      62
    ]
  },
  {
    "data": "23/02/2025",
    "integrantes": [
      7,
      8,
      15,
      3,
      6,
      2,
      1,
      11
    ],
    "musicas": [
      9,
      40,
      17
    ]
  },
  {
    "data": "02/03/2025",
    "integrantes": [
      9,
      8,
      15,
      3,
      6,
      16,
      11
    ],
    "musicas": [
      22,
      4
    ]
  },
  {
    "data": "09/03/2025",
    "integrantes": [
      7,
      4,
      14,
      3,
      12,
      13,
      1,
      11
    ],
    "musicas": [
      64,
      1,
      29
    ]
  },
  {
    "data": "16/03/2025",
    "integrantes": [
      9,
      5,
      2,
      6,
      13,
      16
    ],
    "musicas": [
      41,
      52,
      51
    ]
  },
  {
    "data": "23/03/2025",
    "integrantes": [
      4,
      8,
      14,
      2,
      12,
      13,
      1,
      11
    ],
    "musicas": [
      32,
      46
    ]
  },
  {
    "data": "30/03/2025",
    "integrantes": [
      7,
      5,
      15,
      3,
      12,
      2,
      1
    ],
    "musicas": [
      34,
      21,
      44
    ]
  },
  {
    "data": "06/04/2025",
    "integrantes": [
      4,
      5,
      14,
      2,
      6,
      12,
      1
    ],
    "musicas": [
      67,
      54,
      3
    ]
  },
  {
    "data": "13/04/2025",
    "integrantes": [
      9,
      8,
      15,
      3,
      6,
      2,
      1,
      11
    ],
    "musicas": [
      11,
      43,
      27
    ]
  },
  {
    "data": "20/04/2025",
    "integrantes": [
      7,
      9,
      3,
      2,
      12,
      13,
      1,
      11
    ],
    "musicas": [
      12,
      46
    ]
  },
  {
    "data": "27/04/2025",
    "integrantes": [
      5,
      8,
      15,
      2,
      12,
      13,
      17
    ],
    "musicas": [
      2,
      48,
      16
    ]
  },
  {
    "data": "04/05/2025",
    "integrantes": [
      9,
      8,
      15,
      3,
      12,
      13,
      1
    ],
    "musicas": [
      29,
      10,
      62
    ]
  },
  {
    "data": "11/05/2025",
    "integrantes": [
      4,
      5,
      14,
      3,
      6,
      2,
      1,
      11
    ],
    "musicas": [
      25,
      66,
      38
    ]
  },
  {
    "data": "18/05/2025",
    "integrantes": [
      9,
      8,
      14,
      2,
      6,
      12,
      16,
      11
    ],
    "musicas": [
      20,
      42,
      7
    ]
  },
  {
    "data": "25/05/2025",
    "integrantes": [
      7,
      8,
      15,
      3,
      12,
      2,
      16
    ],
    "musicas": [
      17,
      41,
      9
    ]
  },
  {
    "data": "01/06/2025",
    "integrantes": [
      7,
      8,
      15,
      13,
      12,
      2,
      16
    ],
    "musicas": [
      24,
      39,
      40
    ]
  },
  {
    "data": "08/06/2025",
    "integrantes": [
      4,
      9,
      14,
      13,
      12,
      3,
      1,
      11
    ],
    "musicas": [
      54,
      37,
      43
    ]
  },
  {
    "data": "15/06/2025",
    "integrantes": [
      4,
      8,
      14,
      13,
      12,
      2,
      1,
      11
    ],
    "musicas": [
      15,
      60,
      32
    ]
  },
  {
    "data": "22/06/2025",
    "integrantes": [
      9,
      8,
      15,
      2,
      6,
      3,
      17,
      11
    ],
    "musicas": [
      13,
      67,
      78
    ]
  },
  {
    "data": "29/06/2025",
    "integrantes": [
      9,
      7,
      15,
      2,
      6,
      3,
      1,
      11
    ],
    "musicas": [
      61,
      79,
      77
    ]
  },
  {
    "data": "06/07/2025",
    "integrantes": [
      4,
      14,
      8,
      2,
      6,
      3,
      17,
      11
    ],
    "musicas": [
      8,
      74,
      33
    ]
  },
  {
    "data": "13/07/2025",
    "integrantes": [
      9,
      14,
      8,
      13,
      12,
      3,
      16,
      11
    ],
    "musicas": [
      11,
      46,
      49
    ]
  },
  {
    "data": "20/07/2025",
    "integrantes": [
      9,
      4,
      5,
      13,
      12,
      2,
      16
    ],
    "musicas": [
      68,
      19,
      59
    ]
  },
  {
    "data": "27/07/2025",
    "integrantes": [
      7,
      14,
      15,
      13,
      12,
      2,
      16,
      11
    ],
    "header": [
      7,
      2
    ],
    "musicas": [
      18,
      72,
      16
    ]
  },
  {
    "data": "03/08/2025",
    "integrantes": [
      9,
      14,
      15,
      2,
      6,
      3,
      17,
      11
    ],
    "header": [
      9,
      2
    ],
    "musicas": [
      14,
      29,
      10
    ]
  },
  {
    "data": "10/08/2025",
    "integrantes": [
      7,
      14,
      15,
      2,
      6,
      3,
      1,
      11
    ],
    "header": [
      7,
      1
    ],
    "musicas": [
      25,
      66,
      31
    ]
  },
  {
    "data": "17/08/2025",
    "integrantes": [
      9,
      8,
      5,
      2,
      12,
      3,
      16,
      11
    ],
    "header": [
      9,
      12
    ],
    "musicas": [
      26,
      7,
      48
    ]
  },
  {
    "data": "24/08/2025",
    "integrantes": [
      4,
      8,
      5,
      13,
      6,
      2,
      1,
      11
    ],
    "header": [
      4,
      2
    ],
    "musicas": [
      71,
      56,
      3
    ]
  },
  {
    "data": "31/08/2025",
    "integrantes": [
      4,
      9,
      5,
      13,
      12,
      2,
      16
    ],
    "header": [
      4,
      13
    ],
    "musicas": [
      75,
      53,
      28
    ]
  },
  {
    "data": "07/09/2025",
    "integrantes": [
      7,
      14,
      15,
      13,
      12,
      3,
      1,
      11
    ],
    "header": [
      7,
      13
    ],
    "musicas": [
      23,
      67,
      79
    ]
  },
  {
    "data": "14/09/2025",
    "integrantes": [
      4,
      9,
      5,
      2,
      6,
      3,
      1,
      11
    ],
    "header": [
      4,
      1
    ],
    "musicas": [
      30,
      64,
      73,
      49
    ]
  },
  {
    "data": "21/09/2025",
    "integrantes": [
      9,
      14,
      8,
      2,
      6,
      1
    ],
    "header": [
      9,
      2
    ],
    "musicas": [
      9,
      42,
      78,
      16
    ]
  },
  {
    "data": "28/09/2025",
    "integrantes": [
      4,
      5,
      8,
      2,
      6,
      3,
      1,
      11
    ],
    "header": [
      9,
      2
    ],
    "musicas": [
      68
    ]
  },
  {
    "data": "05/10/2025",
    "integrantes": [
      4,
      5,
      8,
      13,
      12,
      3,
      17,
      11
    ],
    "header": [
      4,
      12
    ],
    "musicas": [
      13,
      74,
      24
    ]
  },
  {
    "data": "12/10/2025",
    "integrantes": [
      7,
      14,
      15,
      13,
      12,
      3,
      16,
      11
    ],
    "header": [
      7,
      13
    ],
    "musicas": [
      61,
      72,
      19,
      15
    ]
  },
  {
    "data": "19/10/2025",
    "integrantes": [
      4,
      5,
      8,
      13,
      12,
      2,
      1,
      18
    ],
    "header": [
      4,
      2
    ],
    "musicas": [
      8,
      70,
      43
    ]
  },
  {
    "data": "26/10/2025",
    "integrantes": [
      9,
      14,
      15,
      2,
      6,
      3,
      16,
      11
    ],
    "header": [
      9,
      1
    ],
    "musicas": [
      55,
      33,
      37
    ]
  },
  {
    "data": "02/11/2025",
    "integrantes": [
      4,
      5,
      8,
      2,
      6,
      3,
      1,
      11
    ],
    "header": [
      4,
      2
    ],
    "musicas": [
      40,
      3,
      76
    ]
  },
  {
    "data": "09/11/2025",
    "integrantes": [
      9,
      14,
      8,
      2,
      6,
      3,
      1,
      18,
      11
    ],
    "header": [
      9,
      1
    ],
    "musicas": [
      46,
      11,
      29,
      10
    ]
  },
  {
    "data": "16/11/2025",
    "integrantes": [
      7,
      5,
      15,
      13,
      12,
      2,
      16
    ],
    "header": [
      7,
      12
    ],
    "musicas": [
      44,
      7,
      77
    ]
  },
  {
    "data": "23/11/2025",
    "integrantes": [
      4,
      14,
      8,
      13,
      6,
      2,
      1,
      18
    ],
    "header": [
      4,
      2
    ],
    "musicas": [
      3,
      33,
      56
    ]
  },
  {
    "data": "30/11/2025",
    "integrantes": [
      7,
      14,
      15,
      13,
      12,
      3,
      17,
      11
    ],
    "header": [
      7,
      13
    ],
    "musicas": [
      75,
      53,
      28
    ]
  },
  {
    "data": "07/12/2025",
    "integrantes": [
      9,
      5,
      15,
      2,
      6,
      3,
      16,
      18
    ],
    "header": [
      9,
      2
    ],
    "musicas": [
      30,
      64,
      73
    ]
  },
  {
    "data": "14/12/2025",
    "integrantes": [
      7,
      4,
      8,
      2,
      6,
      3,
      1,
      11
    ],
    "header": [
      7,
      2
    ],
    "musicas": [
      27,
      38,
      25,
      66
    ]
  },
  {
    "data": "21/12/2025",
    "integrantes": [
      4,
      14,
      5,
      2,
      6,
      3,
      1,
      18
    ],
    "header": [
      4,
      1
    ],
    "musicas": []
  },
  {
    "data": "25/12/2025",
    "integrantes": [
      9,
      4,
      14,
      13,
      6,
      2,
      1,
      11
    ],
    "header": [
      9,
      2
    ],
    "musicas": [
      59,
      88,
      83
    ]
  },
  {
    "data": "28/12/2025",
    "integrantes": [
      9,
      14,
      15,
      13,
      12,
      3,
      17,
      18
    ],
    "header": [
      9,
      13
    ],
    "musicas": [
      42,
      16,
      2
    ]
  },
  {
    "data": "31/12/2025",
    "integrantes": [
      9,
      4,
      8,
      13,
      12,
      3,
      1,
      11
    ],
    "header": [
      4,
      12
    ],
    "musicas": [
      15,
      84,
      76
    ]
  }
];


// ---------- Utils de data ----------
function parseBrDate(str) {
  const [d, m, y] = str.split("/").map(Number);
  return new Date(y, m - 1, d);
}

const MUSIC_BY_ID = new Map(MUSICAS_RAW.map(m => [m.id, m]));
const MEMBER_BY_ID = new Map(INTEGRANTES_RAW.map(i => [i.id, i]));

const HISTORICO = HISTORICO_RAW.map(ev => ({
  ...ev,
  dateObj: parseBrDate(ev.data)
}));

function isValidEvent(ev) {
  return Array.isArray(ev.musicas) && ev.musicas.length > 0;
}

// ---------- Filtros ----------
function getDateFilters() {
  const startInput = document.getElementById("startDate");
  const endInput = document.getElementById("endDate");
  let start = startInput.value ? new Date(startInput.value + "T00:00:00") : null;
  let end = endInput.value ? new Date(endInput.value + "T23:59:59") : null;
  return { start, end };
}

function filterEvents() {
  const { start, end } = getDateFilters();
  return HISTORICO.filter(ev => {
    if (!isValidEvent(ev)) return false;
    if (start && ev.dateObj < start) return false;
    if (end && ev.dateObj > end) return false;
    return true;
  });
}

// ---------- Helpers ----------
function mapToSortedArray(map, keyFn = x => x[1], desc = true) {
  const arr = Array.from(map.entries());
  arr.sort((a, b) => {
    const ka = keyFn(a);
    const kb = keyFn(b);
    return desc ? kb - ka : ka - kb;
  });
  return arr;
}

function splitCategorias(categorias) {
  if (!categorias) return [];
  return categorias.split(";").map(c => c.trim()).filter(Boolean);
}

function integranteImg(member) {
  if (!member) return "";
  return `integrantes/${member.nome.toLowerCase()}.jpeg`;
}

function slugifyArtistName(name) {
  return name
    .normalize("NFD")
    .replace(/[\u0300-\u036f]/g, "")
    .toLowerCase()
    .replace(/[^a-z0-9]+/g, "_")
    .replace(/^_+|_+$/g, "");
}

function artistImg(name) {
  if (!name) return "";
  const slug = slugifyArtistName(name);
  return `artistas/${slug}.jpg`;
}

// ---------- Insights da banda ----------
function computeBandInsights(events) {
  const allMusicIds = [];
  const allArtists = [];
  const allMembers = [];
  const musicFirstSeen = new Map();
  const musicCounts = new Map();
  const artistCounts = new Map();
  const categoriaCounts = new Map();

  for (const ev of events) {
    const date = ev.dateObj;
    const uniqueMembers = Array.from(new Set(ev.integrantes || []));
    for (const mid of uniqueMembers) {
      allMembers.push(mid);
    }

    for (const mid of ev.musicas) {
      allMusicIds.push(mid);
      musicCounts.set(mid, (musicCounts.get(mid) || 0) + 1);
      if (!musicFirstSeen.has(mid)) musicFirstSeen.set(mid, date);

      const musica = MUSIC_BY_ID.get(mid);
      if (!musica) continue;
      allArtists.push(musica.artista);

      artistCounts.set(musica.artista, (artistCounts.get(musica.artista) || 0) + 1);

      for (const cat of splitCategorias(musica.categorias)) {
        categoriaCounts.set(cat, (categoriaCounts.get(cat) || 0) + 1);
      }
    }
  }

  // Garantir catálogo completo para raridades/artistas menos tocados
  for (const musica of MUSICAS_RAW) {
    if (!musicCounts.has(musica.id)) musicCounts.set(musica.id, 0);
    if (!artistCounts.has(musica.artista)) artistCounts.set(musica.artista, 0);
    for (const cat of splitCategorias(musica.categorias)) {
      if (!categoriaCounts.has(cat)) categoriaCounts.set(cat, 0);
    }
  }

  const totalCultos = events.length;
  const totalExecucoes = allMusicIds.length;
  const musicUniqueCount = new Set(allMusicIds).size;
  const artistUniqueCount = new Set(allArtists).size;
  const memberUniqueCount = new Set(allMembers).size;

  // Peso de categoria para desempate de top músicas
  const categoriaScoreByMusic = new Map();
  for (const [mid, count] of musicCounts.entries()) {
    const musica = MUSIC_BY_ID.get(mid);
    let score = 0;
    if (musica) {
      for (const cat of splitCategorias(musica.categorias)) {
        score += categoriaCounts.get(cat) || 0;
      }
    }
    categoriaScoreByMusic.set(mid, score);
  }

  // Top músicas (apenas tocadas no período)
  const musicEntries = Array.from(musicCounts.entries()).filter(([_, c]) => c > 0);
  musicEntries.sort((a, b) => {
    const [idA, countA] = a;
    const [idB, countB] = b;
    if (countB !== countA) return countB - countA;
    const catA = categoriaScoreByMusic.get(idA) || 0;
    const catB = categoriaScoreByMusic.get(idB) || 0;
    if (catB !== catA) return catB - catA;
    const titleA = MUSIC_BY_ID.get(idA)?.titulo || "";
    const titleB = MUSIC_BY_ID.get(idB)?.titulo || "";
    return titleA.localeCompare(titleB);
  });

  const topMusics = musicEntries.slice(0, 10).map(([id, count]) => ({
    id,
    count,
    musica: MUSIC_BY_ID.get(id),
    categoriaScore: categoriaScoreByMusic.get(id) || 0
  }));

  // Raridades (inclui 0 execuções)
  const raridadesEntries = Array.from(musicCounts.entries());
  raridadesEntries.sort((a, b) => {
    const [idA, countA] = a;
    const [idB, countB] = b;
    if (countA !== countB) return countA - countB;
    const titleA = MUSIC_BY_ID.get(idA)?.titulo || "";
    const titleB = MUSIC_BY_ID.get(idB)?.titulo || "";
    return titleA.localeCompare(titleB);
  });
  const raridades = raridadesEntries.slice(0, 10).map(([id, count]) => ({
    id,
    count,
    musica: MUSIC_BY_ID.get(id)
  }));

  // Artistas mais e menos tocados
  const artistEntries = Array.from(artistCounts.entries());
  artistEntries.sort((a, b) => {
    if (b[1] !== a[1]) return b[1] - a[1];
    return a[0].localeCompare(b[0]);
  });
  const topArtistsArr = artistEntries.filter(([_, c]) => c > 0);
  const topArtists = topArtistsArr.slice(0, 10).map(([name, count]) => ({ name, count }));

  const leastArtistEntries = Array.from(artistCounts.entries());
  leastArtistEntries.sort((a, b) => {
    if (a[1] !== b[1]) return a[1] - b[1];
    return a[0].localeCompare(b[0]);
  });
  const leastArtists = leastArtistEntries.slice(0, 10).map(([name, count]) => ({ name, count }));

  // Novas músicas por mês
  const newPerMonth = new Map();
  for (const [mid, firstDate] of musicFirstSeen.entries()) {
    const key = `${firstDate.getFullYear()}-${String(firstDate.getMonth()+1).padStart(2,"0")}`;
    newPerMonth.set(key, (newPerMonth.get(key) || 0) + 1);
  }
  const newPerMonthArr = Array.from(newPerMonth.entries()).sort();

  return {
    totalCultos,
    totalExecucoes,
    musicUniqueCount,
    artistUniqueCount,
    memberUniqueCount,
    topMusics,
    raridades,
    topArtists,
    leastArtists,
    newPerMonthArr
  };
}

// ---------- Insights por integrante ----------
function getPrimaryInstrument(member) {
  if (!member || !member.function || !member.function[0]) return null;
  const fn = member.function[0];
  const entries = Object.entries(fn);
  const priority = { hard: 3, medium: 2, easy: 1, "": 0 };
  entries.sort((a, b) => (priority[b[1]] || 0) - (priority[a[1]] || 0));
  return entries.length ? entries[0][0] : null;
}

function computeMemberInsights(events, memberId) {
  const member = MEMBER_BY_ID.get(memberId);
  if (!member) return null;

  const eventsWithMember = events.filter(ev => (ev.integrantes || []).includes(memberId));
  const totalCultosComMembro = eventsWithMember.length;
  const totalCultosPeriodo = events.length;
  const participacaoPercent = totalCultosPeriodo > 0
    ? Math.round((totalCultosComMembro / totalCultosPeriodo) * 100)
    : 0;

  const allMusicIds = [];
  const allArtists = [];
  const musicCounts = new Map();
  const musicCountsEscolhidas = new Map();
  const artistCounts = new Map();
  const artistCountsEscolhidos = new Map();
  const parceiroCounts = new Map();

  const musicTotalCounts = new Map();
  for (const ev of events) {
    for (const mid of ev.musicas) {
      musicTotalCounts.set(mid, (musicTotalCounts.get(mid) || 0) + 1);
    }
  }
  const musicCountsComMembro = new Map();

  for (const ev of eventsWithMember) {
    const outros = (ev.integrantes || []).filter(id => id !== memberId);
    for (const o of outros) {
      parceiroCounts.set(o, (parceiroCounts.get(o) || 0) + 1);
    }

    for (const mid of ev.musicas) {
      allMusicIds.push(mid);
      musicCounts.set(mid, (musicCounts.get(mid) || 0) + 1);
      const musica = MUSIC_BY_ID.get(mid);
      if (!musica) continue;
      allArtists.push(musica.artista);
      artistCounts.set(musica.artista, (artistCounts.get(musica.artista) || 0) + 1);

      musicCountsComMembro.set(mid, (musicCountsComMembro.get(mid) || 0) + 1);
    }
  }

  for (const ev of events) {
    if (!Array.isArray(ev.header) || !ev.header.includes(memberId)) continue;
    for (const mid of ev.musicas) {
      musicCountsEscolhidas.set(mid, (musicCountsEscolhidas.get(mid) || 0) + 1);
      const musica = MUSIC_BY_ID.get(mid);
      if (!musica) continue;
      artistCountsEscolhidos.set(musica.artista, (artistCountsEscolhidos.get(musica.artista) || 0) + 1);
    }
  }

  const totalExecucoes = allMusicIds.length;
  const uniqueArtistsCount = new Set(allArtists).size;

  const topMusicsTocadas = mapToSortedArray(musicCounts).slice(0, 10).map(([id, count]) => ({
    id, count, musica: MUSIC_BY_ID.get(id)
  }));
  const topMusicsEscolhidas = mapToSortedArray(musicCountsEscolhidas).slice(0, 10).map(([id, count]) => ({
    id, count, musica: MUSIC_BY_ID.get(id)
  }));
  const topArtistsTocados = mapToSortedArray(artistCounts).slice(0, 10).map(([name, count]) => ({ name, count }));
  const topArtistsEscolhidos = mapToSortedArray(artistCountsEscolhidos).slice(0, 10).map(([name, count]) => ({ name, count }));
  const parceiros = mapToSortedArray(parceiroCounts).slice(0, 10).map(([pid, count]) => ({
    member: MEMBER_BY_ID.get(pid), count
  }));
  const topParceiro = parceiros[0] || null;

  const assinatura = [];
  for (const [mid, withCount] of musicCountsComMembro.entries()) {
    const total = musicTotalCounts.get(mid) || 0;
    if (total < 2) continue;
    const ratio = withCount / total;
    if (ratio >= 0.75) {
      assinatura.push({
        id: mid,
        musica: MUSIC_BY_ID.get(mid),
        withCount,
        total,
        ratio
      });
    }
  }
  assinatura.sort((a, b) => b.ratio - a.ratio || b.withCount - a.withCount);
  const assinaturaTop = assinatura.slice(0, 10);

  const primaryInstrument = getPrimaryInstrument(member);
  const difficultyCounts = { easy: 0, medium: 0, hard: 0, unknown: 0 };
  if (primaryInstrument) {
    for (const ev of eventsWithMember) {
      for (const mid of ev.musicas) {
        const musica = MUSIC_BY_ID.get(mid);
        if (!musica || !musica.level) {
          difficultyCounts.unknown++;
          continue;
        }
        const lvl = musica.level[primaryInstrument] || "unknown";
        if (!difficultyCounts[lvl]) difficultyCounts[lvl] = 0;
        difficultyCounts[lvl]++;
      }
    }
  }

  return {
    member,
    totalCultosComMembro,
    totalCultosPeriodo,
    participacaoPercent,
    totalExecucoes,
    uniqueArtistsCount,
    topMusicsTocadas,
    topMusicsEscolhidas,
    topArtistsTocados,
    topArtistsEscolhidos,
    parceiros,
    topParceiro,
    assinaturaTop,
    primaryInstrument,
    difficultyCounts
  };
}

// ---------- Render helpers ----------
function createCard(title, contentHtml, extraClass = "") {
  const div = document.createElement("div");
  div.className = "card " + extraClass;
  div.innerHTML = `
    <h3 class="card-title">${title}</h3>
    <div class="card-content">${contentHtml}</div>
  `;
  return div;
}

function renderBandSection(events) {
  const insights = computeBandInsights(events);
  const root = document.getElementById("bandSection");
  root.innerHTML = "";

  // Resumo com ícones
  const summary = document.createElement("div");
  summary.className = "card-grid summary-grid";

  summary.appendChild(createCard(
    "Cultos no período",
    `
    <div class="summary-metric">
      <div class="summary-icon summary-icon-purple">📅</div>
      <div>
        <p class="summary-label">Cultos no período</p>
        <p class="big-number">${insights.totalCultos}</p>
      </div>
    </div>
    `,
    "summary-card summary-cultos"
  ));

  summary.appendChild(createCard(
    "Execuções de músicas",
    `
    <div class="summary-metric">
      <div class="summary-icon summary-icon-green">🎵</div>
      <div>
        <p class="summary-label">Execuções de músicas</p>
        <p class="big-number">${insights.totalExecucoes}</p>
      </div>
    </div>
    `,
    "summary-card summary-execs"
  ));

  summary.appendChild(createCard(
    "Músicas diferentes",
    `
    <div class="summary-metric">
      <div class="summary-icon summary-icon-blue">📚</div>
      <div>
        <p class="summary-label">Músicas diferentes</p>
        <p class="big-number">${insights.musicUniqueCount}</p>
      </div>
    </div>
    `,
    "summary-card summary-musics"
  ));

  summary.appendChild(createCard(
    "Artistas diferentes",
    `
    <div class="summary-metric">
      <div class="summary-icon summary-icon-pink">👥</div>
      <div>
        <p class="summary-label">Artistas diferentes</p>
        <p class="big-number">${insights.artistUniqueCount}</p>
      </div>
    </div>
    `,
    "summary-card summary-artists"
  ));

  root.appendChild(summary);

  // ----- Linha 1: Top músicas + Raridades -----
  const featuredTracks = insights.topMusics.slice(0, 3);
  const restTracks = insights.topMusics.slice(3);

  const featuredTracksHtml = featuredTracks.map((m, idx) => {
    const banBadge = m.musica && m.musica.ban ? '<span class="badge badge-ban">BANIDA</span>' : "";
    const thumb = m.musica ? `<a href="https://www.youtube.com/watch?v=${m.musica.referLink}" target="_blank">
      <img class="thumb thumb-xl" src="https://img.youtube.com/vi/${m.musica.referLink}/0.jpg" alt="thumb">
    </a>` : "";
    return `
      <div class="track-feature-card">
        <div class="track-feature-left">
          <div class="track-rank-badge">#${idx + 1}</div>
          ${thumb}
        </div>
        <div class="track-feature-info">
          <div class="track-title">${m.musica ? m.musica.titulo : "ID " + m.id} ${banBadge}</div>
          <div class="track-artist">${m.musica ? m.musica.artista : ""}</div>
          <div class="track-count-row">
            <span class="track-count">${m.count}× no período</span>
          </div>
        </div>
      </div>
    `;
  }).join("");

  const restTracksHtml = restTracks.map((m, idx) => {
    const banBadge = m.musica && m.musica.ban ? '<span class="badge badge-ban">BANIDA</span>' : "";
    const thumb = m.musica ? `<a href="https://www.youtube.com/watch?v=${m.musica.referLink}" target="_blank">
      <img class="thumb thumb-md" src="https://img.youtube.com/vi/${m.musica.referLink}/0.jpg" alt="thumb">
    </a>` : "";
    return `
      <li class="top-track-item">
        <div class="top-track-left">
          <span class="rank">#${idx + 4}</span>
          ${thumb}
          <div class="track-info">
            <div class="track-title">${m.musica ? m.musica.titulo : "ID " + m.id} ${banBadge}</div>
            <div class="track-artist">${m.musica ? m.musica.artista : ""}</div>
          </div>
        </div>
        <span class="track-count">${m.count}×</span>
      </li>
    `;
  }).join("");

  const topMusicsCardHtml = `
    <div class="track-featured-row">
      ${featuredTracksHtml || "<p class='muted'>Nenhuma música no período.</p>"}
    </div>
    ${restTracks.length ? `<ul class="list top-tracks">${restTracksHtml}</ul>` : ""}
  `;
  const topMusicsCard = createCard("Top músicas da banda", topMusicsCardHtml);

  const featuredRares = insights.raridades.slice(0, 3);
  const restRares = insights.raridades.slice(3);

  const featuredRaresHtml = featuredRares.map((m, idx) => {
    const thumb = m.musica ? `<a href="https://www.youtube.com/watch?v=${m.musica.referLink}" target="_blank">
      <img class="thumb thumb-xl" src="https://img.youtube.com/vi/${m.musica.referLink}/0.jpg" alt="thumb">
    </a>` : "";
    return `
      <div class="track-feature-card">
        <div class="track-feature-left">
          <div class="track-rank-badge">#${idx + 1}</div>
          ${thumb}
        </div>
        <div class="track-feature-info">
          <div class="track-title">${m.musica ? m.musica.titulo : "ID " + m.id}</div>
          <div class="track-artist">${m.musica ? m.musica.artista : ""}</div>
          <div class="track-count-row">
            <span class="track-count">${m.count}× no período</span>
          </div>
        </div>
      </div>
    `;
  }).join("");

  const restRaresHtml = restRares.map((m, idx) => {
    const thumb = m.musica ? `<a href="https://www.youtube.com/watch?v=${m.musica.referLink}" target="_blank">
      <img class="thumb thumb-md" src="https://img.youtube.com/vi/${m.musica.referLink}/0.jpg" alt="thumb">
    </a>` : "";
    return `
      <li class="top-track-item">
        <div class="top-track-left">
          <span class="rank">#${idx + 4}</span>
          ${thumb}
          <div class="track-info">
            <div class="track-title">${m.musica ? m.musica.titulo : "ID " + m.id}</div>
            <div class="track-artist">${m.musica ? m.musica.artista : ""}</div>
          </div>
        </div>
        <span class="track-count">${m.count}×</span>
      </li>
    `;
  }).join("");

  const raridadesCardHtml = `
    <div class="track-featured-row">
      ${featuredRaresHtml || "<p class='muted'>Não há músicas raras no período.</p>"}
    </div>
    ${restRares.length ? `<ul class="list top-tracks">${restRaresHtml}</ul>` : ""}
  `;
  const raridadesCard = createCard("Raridades do período (músicas menos tocadas)", raridadesCardHtml);

  const rowTracks = document.createElement("div");
  rowTracks.className = "band-row";
  rowTracks.appendChild(topMusicsCard);
  rowTracks.appendChild(raridadesCard);
  root.appendChild(rowTracks);

  // ----- Linha 2: Top artistas + Artistas menos tocados -----
  const featuredTopArtists = insights.topArtists.slice(0, 3);
  const restTopArtists = insights.topArtists.slice(3);

  const featuredTopArtistsHtml = featuredTopArtists.map((a, idx) => {
    const initials = a.name.split(" ").map(p => p[0]).join("").slice(0, 3).toUpperCase();
    const imgSrc = artistImg(a.name);
    return `
      <div class="artist-feature-card">
        <div class="artist-avatar">
          <img src="${imgSrc}" alt="${a.name}" onerror="this.style.display='none';" />
          <div class="artist-avatar-inner">${initials}</div>
        </div>
        <div class="artist-meta">
          <div class="artist-name">#${idx + 1} · ${a.name}</div>
          <div class="artist-count">${a.count} execuções</div>
        </div>
      </div>
    `;
  }).join("");

  const restTopArtistsHtml = restTopArtists.map((a, idx) => {
    const initials = a.name.split(" ").map(p => p[0]).join("").slice(0, 3).toUpperCase();
    const imgSrc = artistImg(a.name);
    return `
      <li class="artist-row">
        <div class="artist-row-main">
          <span class="rank">#${idx + 4}</span>
          <div class="artist-avatar artist-avatar-sm">
            <img src="${imgSrc}" alt="${a.name}" onerror="this.style.display='none';" />
            <div class="artist-avatar-inner">${initials}</div>
          </div>
          <span class="artist-row-name">${a.name}</span>
        </div>
        <span class="track-count">${a.count}×</span>
      </li>
    `;
  }).join("");

  const artistasCardHtml = `
    <div class="artist-featured-row">
      ${featuredTopArtistsHtml || "<p class='muted'>Nenhum artista no período.</p>"}
    </div>
    ${restTopArtists.length ? `<ul class="list">${restTopArtistsHtml}</ul>` : ""}
  `;
  const artistasCard = createCard("Artistas mais tocados", artistasCardHtml);

  const leastArtists = insights.leastArtists;
  const leastFeatured = leastArtists.slice(0, 3);
  const leastRest = leastArtists.slice(3);

  const leastFeaturedHtml = leastFeatured.map((a, idx) => {
    const initials = a.name.split(" ").map(p => p[0]).join("").slice(0, 3).toUpperCase();
    const imgSrc = artistImg(a.name);
    return `
      <div class="artist-feature-card">
        <div class="artist-avatar">
          <img src="${imgSrc}" alt="${a.name}" onerror="this.style.display='none';" />
          <div class="artist-avatar-inner">${initials}</div>
        </div>
        <div class="artist-meta">
          <div class="artist-name">#${idx + 1} · ${a.name}</div>
          <div class="artist-count">${a.count} execuções</div>
        </div>
      </div>
    `;
  }).join("");

  const leastRestHtml = leastRest.map((a, idx) => {
    const initials = a.name.split(" ").map(p => p[0]).join("").slice(0, 3).toUpperCase();
    const imgSrc = artistImg(a.name);
    return `
      <li class="artist-row">
        <div class="artist-row-main">
          <span class="rank">#${idx + 4}</span>
          <div class="artist-avatar artist-avatar-sm">
            <img src="${imgSrc}" alt="${a.name}" onerror="this.style.display='none';" />
            <div class="artist-avatar-inner">${initials}</div>
          </div>
          <span class="artist-row-name">${a.name}</span>
        </div>
        <span class="track-count">${a.count}×</span>
      </li>
    `;
  }).join("");

  const leastArtistsHtml = `
    <div class="artist-featured-row">
      ${leastFeaturedHtml || "<p class='muted'>Nenhum artista cadastrado.</p>"}
    </div>
    ${leastRest.length ? `<ul class="list">${leastRestHtml}</ul>` : ""}
  `;
  const leastArtistsCard = createCard("Artistas menos tocados", leastArtistsHtml);

  const rowArtists = document.createElement("div");
  rowArtists.className = "band-row band-row-bottom";
  rowArtists.appendChild(artistasCard);
  rowArtists.appendChild(leastArtistsCard);
  root.appendChild(rowArtists);

  // ----- Novas músicas por mês -----
  const newMonthArr = insights.newPerMonthArr;
  let chartHtml = "<p class='muted'>Quantas músicas estrearam em cada mês do período filtrado.</p>";
  if (newMonthArr.length) {
    const maxCount = Math.max(...newMonthArr.map(([_, c]) => c), 1);
    const bars = newMonthArr.map(([ym, count]) => {
      const [y, m] = ym.split("-");
      const heightPercent = Math.round((count / maxCount) * 100);
      return `
        <div class="chart-bar">
          <div class="chart-bar-inner" style="height: ${heightPercent}%;"></div>
          <span class="chart-bar-value">${count}</span>
          <span class="chart-bar-label">${m}/${y}</span>
        </div>
      `;
    }).join("");
    chartHtml += `<div class="chart">${bars}</div>`;
  } else {
    chartHtml += "<p>Não houve músicas novas no período.</p>";
  }
  root.appendChild(createCard("Novas músicas por mês", chartHtml));
}

function renderMemberSection(events) {
  const select = document.getElementById("memberFilter");
  const memberId = parseInt(select.value, 10);
  const root = document.getElementById("memberSection");
  root.innerHTML = "";

  if (isNaN(memberId)) {
    root.innerHTML = "<p class='muted'>Selecione um integrante acima para ver o perfil detalhado.</p>";
    return;
  }

  const insights = computeMemberInsights(events, memberId);
  if (!insights) {
    root.innerHTML = "<p class='muted'>Não foi possível calcular os dados desse integrante.</p>";
    return;
  }

  const header = document.createElement("div");
  header.className = "member-header card";
  const imgSrc = integranteImg(insights.member);
  header.innerHTML = `
    <div class="member-header-main">
      <div class="avatar avatar-lg">
        <img src="${imgSrc}" alt="${insights.member.nome}" onerror="this.style.visibility='hidden';" />
      </div>
      <div>
        <h2>${insights.member.nome}</h2>
        <p>Participou de <strong>${insights.totalCultosComMembro}</strong> cultos (${insights.participacaoPercent}% dos cultos do período filtrado).</p>
        <p>Tocou em <strong>${insights.totalExecucoes}</strong> execuções de músicas, envolvendo <strong>${insights.uniqueArtistsCount}</strong> artistas diferentes.</p>
      </div>
    </div>
  `;
  root.appendChild(header);

  const grid = document.createElement("div");
  grid.className = "card-grid";

  // Helpers blocos

  function buildMusicBlock(musics, emptyMsg, countLabelFn) {
    if (!musics || musics.length === 0) {
      return `<p class="muted">${emptyMsg}</p>`;
    }
    const [feat, ...rest] = musics;
    const featThumb = feat.musica ? `<a href="https://www.youtube.com/watch?v=${feat.musica.referLink}" target="_blank">
      <img class="thumb thumb-xl" src="https://img.youtube.com/vi/${feat.musica.referLink}/0.jpg" alt="thumb">
    </a>` : "";
    const featHtml = `
      <div class="track-feature-card">
        <div class="track-feature-left">
          <div class="track-rank-badge">#1</div>
          ${featThumb}
        </div>
        <div class="track-feature-info">
          <div class="track-title">${feat.musica ? feat.musica.titulo : "ID " + feat.id}</div>
          <div class="track-artist">${feat.musica ? feat.musica.artista : ""}</div>
          <div class="track-count-row">
            <span class="track-count">${countLabelFn(feat, 1)}</span>
          </div>
        </div>
      </div>
    `;
    const restHtml = rest.map((m, idx) => {
      const thumb = m.musica ? `<a href="https://www.youtube.com/watch?v=${m.musica.referLink}" target="_blank">
        <img class="thumb thumb-md" src="https://img.youtube.com/vi/${m.musica.referLink}/0.jpg" alt="thumb">
      </a>` : "";
      return `
        <li class="top-track-item">
          <div class="top-track-left">
            <span class="rank">#${idx + 2}</span>
            ${thumb}
            <div class="track-info">
              <div class="track-title">${m.musica ? m.musica.titulo : "ID " + m.id}</div>
              <div class="track-artist">${m.musica ? m.musica.artista : ""}</div>
            </div>
          </div>
          <span class="track-count">${countLabelFn(m, idx + 2)}</span>
        </li>
      `;
    }).join("");
    return `
      <div class="track-featured-row">
        ${featHtml}
      </div>
      ${rest.length ? `<ul class="list top-tracks">${restHtml}</ul>` : ""}
    `;
  }

  function buildArtistBlock(artists, emptyMsg) {
    if (!artists || artists.length === 0) {
      return `<p class="muted">${emptyMsg}</p>`;
    }
    const [feat, ...rest] = artists;
    const initialsFeat = feat.name.split(" ").map(p => p[0]).join("").slice(0, 3).toUpperCase();
    const imgSrcFeat = artistImg(feat.name);
    const featHtml = `
      <div class="artist-feature-card">
        <div class="artist-avatar">
          <img src="${imgSrcFeat}" alt="${feat.name}" onerror="this.style.display='none';" />
          <div class="artist-avatar-inner">${initialsFeat}</div>
        </div>
        <div class="artist-meta">
          <div class="artist-name">#1 · ${feat.name}</div>
          <div class="artist-count">${feat.count} execuções</div>
        </div>
      </div>
    `;
    const restHtml = rest.map((a, idx) => {
      const initials = a.name.split(" ").map(p => p[0]).join("").slice(0, 3).toUpperCase();
      const imgSrcA = artistImg(a.name);
      return `
        <li class="artist-row">
          <div class="artist-row-main">
            <span class="rank">#${idx + 2}</span>
            <div class="artist-avatar artist-avatar-sm">
              <img src="${imgSrcA}" alt="${a.name}" onerror="this.style.display='none';" />
              <div class="artist-avatar-inner">${initials}</div>
            </div>
            <span class="artist-row-name">${a.name}</span>
          </div>
          <span class="track-count">${a.count}×</span>
        </li>
      `;
    }).join("");
    return `
      <div class="artist-featured-row">
        ${featHtml}
      </div>
      ${rest.length ? `<ul class="list">${restHtml}</ul>` : ""}
    `;
  }

  function buildParceriasBlock(parceiros) {
    if (!parceiros || parceiros.length === 0) {
      return `<p class="muted">Nenhuma parceria recorrente.</p>`;
    }
    const [feat, ...rest] = parceiros;
    const imgFeat = feat.member ? integranteImg(feat.member) : "";
    const featHtml = `
      <div class="pair-feature-card">
        <div class="avatar avatar-lg">
          <img src="${imgFeat}" alt="${feat.member ? feat.member.nome : ""}" onerror="this.style.visibility='hidden';" />
        </div>
        <div class="pair-info">
          <div class="pair-names">${feat.member ? feat.member.nome : "Integrante"}</div>
          <div class="pair-count">${feat.count} cultos juntos</div>
        </div>
      </div>
    `;
    const restHtml = rest.map((p) => {
      if (!p.member) return "";
      const imgP = integranteImg(p.member);
      return `
        <li class="member-item">
          <div class="member-main">
            <div class="avatar avatar-sm">
              <img src="${imgP}" alt="${p.member.nome}" onerror="this.style.visibility='hidden';" />
            </div>
            <div class="member-info">
              <div class="member-name">${p.member.nome}</div>
            </div>
          </div>
          <span class="track-count">${p.count} cultos juntos</span>
        </li>
      `;
    }).join("");
    return `
      ${featHtml}
      ${rest.length ? `<ul class="list">${restHtml}</ul>` : ""}
    `;
  }

  // Músicas que mais tocou
  const tocadasHtml = buildMusicBlock(
    insights.topMusicsTocadas,
    "Nenhuma música.",
    (m) => `${m.count}×`
  );
  grid.appendChild(createCard("Músicas que mais tocou", tocadasHtml));

  // Músicas que mais escolheu
  const escolhidasHtmlInner = buildMusicBlock(
    insights.topMusicsEscolhidas,
    "Nenhuma informação de escolha.",
    (m) => `${m.count}×`
  );
  grid.appendChild(createCard(
    "Músicas que mais escolheu",
    `<p class="muted">Considerando cultos em que esteve no header.</p>${escolhidasHtmlInner}`
  ));

  // Artistas que mais tocou
  const artistasTocHtml = buildArtistBlock(
    insights.topArtistsTocados,
    "Nenhum artista."
  );
  grid.appendChild(createCard("Artistas que mais tocou", artistasTocHtml));

  // Artistas que mais escolheu
  const artistasEscHtml = buildArtistBlock(
    insights.topArtistsEscolhidos,
    "Nenhum dado de escolha."
  );
  grid.appendChild(createCard("Artistas que mais escolheu", artistasEscHtml));

  // Parcerias
  const parceirosHtml = buildParceriasBlock(insights.parceiros);
  grid.appendChild(createCard("Com quem mais tocou", parceirosHtml));

  // Músicas assinatura
  const assinaturaHtml = buildMusicBlock(
    insights.assinaturaTop,
    "Nenhuma música se destacou como assinatura.",
    (a) => `${a.withCount} / ${a.total} (${Math.round(a.ratio * 100)}%)`
  );
  grid.appendChild(createCard(
    "Músicas assinatura",
    `<p class="muted">Músicas em que essa pessoa está na maior parte das execuções.</p>${assinaturaHtml}`
  ));

  // Desafios do período (visual melhorado)
  let diffHtml = "";
  if (insights.primaryInstrument) {
    const dc = insights.difficultyCounts;
    const totalDiff = (dc.easy || 0) + (dc.medium || 0) + (dc.hard || 0) + (dc.unknown || 0);
    function pct(v) {
      if (!totalDiff) return 0;
      return Math.round((v / totalDiff) * 100);
    }
    diffHtml += `<p class="muted">Instrumento principal considerado: <strong>${insights.primaryInstrument}</strong>. Como foi o nível de desafio das músicas tocadas?</p>`;
    diffHtml += `<div class="difficulty-grid">`;

    const levels = [
      { key: "easy", label: "🎧 Easy", class: "difficulty-easy" },
      { key: "medium", label: "🥁 Medium", class: "difficulty-medium" },
      { key: "hard", label: "🔥 Hard", class: "difficulty-hard" },
      { key: "unknown", label: "❓ Sem info", class: "difficulty-unknown" }
    ];

    for (const lvl of levels) {
      const count = dc[lvl.key] || 0;
      const percent = pct(count);
      diffHtml += `
        <div class="difficulty-item">
          <div class="difficulty-header">
            <span class="difficulty-label ${lvl.class}">${lvl.label}</span>
            <span class="difficulty-count">${count} músicas</span>
          </div>
          <div class="difficulty-bar">
            <div class="difficulty-bar-fill ${lvl.class}" style="width: ${percent}%;"></div>
          </div>
        </div>
      `;
    }
    diffHtml += `</div>`;
  } else {
    diffHtml += "<p class='muted'>Não foi possível determinar um instrumento principal para esse integrante.</p>";
  }
  grid.appendChild(createCard("Desafios do período", diffHtml));

  root.appendChild(grid);
}

// ---------- Navegação entre visões ----------
function setActiveView(view) {
  const tabs = document.querySelectorAll(".view-tab");
  tabs.forEach(btn => {
    btn.classList.toggle("active", btn.dataset.view === view);
  });
  const inner = document.querySelector(".views-inner");
  if (inner) {
    inner.style.transform = view === "member" ? "translateX(-100%)" : "translateX(0)";
  }
}

function populateMemberFilter() {
  const select = document.getElementById("memberFilter");
  select.innerHTML = '<option value="">Todos os integrantes</option>';
  const sorted = [...INTEGRANTES_RAW].sort((a, b) => a.nome.localeCompare(b.nome));
  for (const m of sorted) {
    const opt = document.createElement("option");
    opt.value = m.id;
    opt.textContent = m.nome;
    select.appendChild(opt);
  }
}

function applyFiltersAndRender() {
  const events = filterEvents();
  renderBandSection(events);
  renderMemberSection(events);
}

document.addEventListener("DOMContentLoaded", () => {
  populateMemberFilter();
  if (HISTORICO.length > 0) {
    const sorted = [...HISTORICO].sort((a, b) => a.dateObj - b.dateObj);
    const min = sorted[0].dateObj;
    const max = sorted[sorted.length - 1].dateObj;
    const startInput = document.getElementById("startDate");
    const endInput = document.getElementById("endDate");
    const toInput = d => `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`;
    startInput.value = toInput(min);
    endInput.value = toInput(max);
  }
  document.getElementById("startDate").addEventListener("change", applyFiltersAndRender);
  document.getElementById("endDate").addEventListener("change", applyFiltersAndRender);
  document.getElementById("memberFilter").addEventListener("change", applyFiltersAndRender);
  document.querySelectorAll(".view-tab").forEach(btn => {
    btn.addEventListener("click", () => setActiveView(btn.dataset.view));
  });
  applyFiltersAndRender();
  setActiveView("band");
});